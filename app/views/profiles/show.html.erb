<% @page_title = "User profile: #{@user.username} - " + application_name %>

<h1>User Profile</h1>

<dl class="dl-horizontal dl-invert">
    <dt>Username</dt>
    <dd>
        <%= @user.username %>
    </dd>
    <dt>Name</dt>
    <dd>
        <%= @user.fullname || "(None)" %>
    </dd>
    <dt>Institutional Affiliation</dt>
    <dd>
        <%= @user.institutional_affiliation || "(None/Unknown)" %>
    </dd>
    <dt>Role</dt>
    <dd>
        <%= @user.role.capitalize %>
    </dd>
    <dt>Email</dt>
    <dd>
        <% if @user.email_is_public %><%= mail_to @user.email %><% else %>(Private)<% end %>
    </dd>
    <dt>Bio</dt>
    <dd>
        <%= @user.bio || "N/A" %>
    </dd>
    <dt>Contributions</dt>
    <dd>
        <%= Source.where(created_by: @user).count %> sources<br/>
        <% num_approved = Entry.where(created_by: @user, approved: true).count %>
	<% num_unapproved = Entry.where(created_by: @user, approved: false).count %>
        <a href="<%= search_advanced_path(created_by: @user.to_s) %>"><%= num_approved %> entries</a>
	<% if num_unapproved > 0 %>(<%= num_unapproved %> not yet approved)<% end %>
	<br/>
        <%= Comment.where(created_by: @user).count %> comments
        <% if (num_corrections = Comment.where(created_by: @user, is_correction: true)).count > 0 %>
            (<%= num_corrections %> of which are corrections to entries)
        <% end %><br/>
        </ul>
    </dd>
</dl>
