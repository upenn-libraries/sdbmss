<!-- MODAL for creating a new (Person) Name Authority record from within create/edit source or entry -->

<script type="text/ng-template" id="createName.html">
    <div class="modal-header">
        <h3 class="modal-title">Create {{ entityName }}
            <a href="" class="btn btn-default pull-right" ng-click="goBack()"><span class="glyphicon glyphicon-circle-arrow-left"></span> Go Back</a>
        </h3>
    </div>
    <div class="modal-body form-horizontal compress-whitespace">

        <p>This window asks you to create an authorized name to
        facilitate standardization and searchability for this
        entity. Type the name of a person or institution into the Name
        field, then click “Find Suggestions” to access standardized
        names from the Virtual International Authority File (VIAF). If
        the name you are searching appears in the list, click on the
        VIAF ID number to check that this is the name you wish to
        use. If it is, return to window and click “Use this info” to
        populate the Name and VIAF ID fields automatically. If the
        name does not appear in the VIAF suggestions list, you must create your own
        standardized name by following the SDBM NAME STANDARD: <strong>Last name, First name, Title, Dates <em>(if known)</em>.</strong>
        You will not need to enter a VIAF ID.</p>

        <p>Tip: Remember that the name of a person or an institution
        can have variant spellings. If you don’t find a name, consider other
        possible spellings.</p>

        <div class="form-group row">
            <label class="col-sm-2 control-label" sdbm-tooltip="create_name_name">Name</label>
            <div class="col-sm-5">
                <input type="text" name="name" class="form-control" ng-model="entity.name">
            </div>
            <div class="col-sm-3">
                <button ng-click="findSuggestions(entity.name)" ng-disabled="loading" class="btn btn-primary">Find Suggestions in VIAF</button>
            </div>
            <div class="col-sm-1">
                <img id="spinner" alt="working..." src="<%= asset_path "spinner.gif" %>" ng-show="loading"/>
            </div>
        </div>

        <div class="form-group row" ng-show="hasViafId">
            <label class="col-sm-2 control-label" sdbm-tooltip="create_name_viaf">VIAF ID</label>
            <div class="col-sm-2">
                <input type="text" class="form-control" ng-model="entity.viaf_id">
            </div>
        </div>

        <div class="form-group row" ng-show="hasViafId">
            <label class="col-sm-2 control-label" sdbm-tooltip="create_name_other">Other Info</label>
            <div class="col-sm-7">
                <input type="text" class="form-control" ng-model="entity.other_info">
            </div>
        </div>

        
        <div ng-show="showSuggestions">
            <table ng-show="suggestions.length > 0" class="table table-striped table-compressed">
                <thead>
                    <tr>
                        <th class="col-sm-6"><b>Name</b></th>
                        <th class="col-sm-2"><b>VIAF ID</b></th>
                        <th class="col-sm-2"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr data-ng-repeat="suggestion in suggestions">
                        <td class="col-sm-6">{{ suggestion.name }}</td>
                        <td class="col-sm-2"><a target="_blank" href="http://viaf.org/viaf/{{ suggestion.viaf_id }}/">{{ suggestion.viaf_id }}</a></td>
                        <td class="col-sm-2"><a ng-click="useSuggestion(suggestion)" href="#">Use this info</a></td>
                    </tr>
                </tbody>
            </table>
            <div ng-show="!loading && suggestions.length == 0">No suggestions found.</div>
        </div>

        <p ng-show="message">{{ message }}</p>

        <p ng-repeat="e in errors track by $index" ng-if="errors.length > 0">
            Error: {{ e.message }} <a class='btn btn-success' ng-if="e.name && e.name.name" ng-click="useExisting(e.name)">Use {{ e.name.name }}</a>
        </p>
        
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary create-name-button" ng-click="save()" ng-show="readyToCreate" id='save-propose-name'>Create</button>
        <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
    </div>
</script>
