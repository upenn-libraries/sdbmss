title = "gitleaks config"

[[rules]]
description = "Password in string"
regex = '''(?i)[\w]*(password|secret)[\w]* *[:=>,]+ *['"][\S]{2,}['"]'''
[[rules]]
description = "Password in YAML config"
regex = '''(?i)[\w]*(password|secret)[\w]* *: *[\S]{2,}'''
[[rules]]
description = "AWS"
regex = '''AKIA[0-9A-Z]{16}'''
[[rules]]
description = "RKCS8"
regex = '''-----BEGIN PRIVATE KEY-----'''
[[rules]]
description = "RSA"
regex = '''-----BEGIN RSA PRIVATE KEY-----'''
[[rules]]
description = "Github"
regex = '''(?i)github.*['\"][0-9a-zA-Z]{35,40}['\"]'''
[[rules]]
description = "SSH"
regex = '''-----BEGIN OPENSSH PRIVATE KEY-----'''
[[rules]]
description = "Facebook"
regex = '''(?i)facebook.*['\"][0-9a-f]{32}['\"]'''
[[rules]]
description = "Twitter"
regex = '''(?i)twitter.*['\"][0-9a-zA-Z]{35,44}['\"]'''
[[rules]]
description = "PGP"
regex = '''-----BEGIN PGP PRIVATE KEY BLOCK-----'''
[[rules]]
description = "Slack token"
regex = '''xox[baprs]-.*'''
[[rules]]
description = "Strip API Key"
regex = '''(?i)(sk|pk)_(test|live)_[0-9a-zA-Z]{10,32}'''

[whitelist]
commits = [
]
files = [
  'spec/features/sign_up_spec.rb',
]
regexes = [
  # Values set by Ansible variables
  '''{{ *[\S]+ *}}''',
  # Values set by environment variables
  '''ENV\[['"][\S]+['"]\]''',
  # References to Docker secret password files
  '''_+FILE:''',
  # Postgres password encryption settings
  '''password_encryption''',
  # Ansible variables setting Docker secret / config versions
  '''_version:''',
  # Development and test database passwords
  '''password: metridoc_(development|test)''',
  # Example secret key in Devise initializer
  '''# config.secret_key =''',
  # AWS Secrets Manager resource for vault password
  '''AnsibleVaultPassword''',
]
